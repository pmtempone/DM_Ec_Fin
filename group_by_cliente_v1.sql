/*avg,min, max por cliente de ultimos 6 meses*/

select numero_de_cliente,
  avg(mrentabilidad) as avg_mrentabilidad,
  min(mrentabilidad) as min_mrentabilidad,
  max(mrentabilidad) as max_mrentabilidad,
  avg(mrentabilidad_annual) as avg_mrentabilidad_annual,
  min(mrentabilidad_annual) as min_mrentabilidad_annual,
  max(mrentabilidad_annual) as max_mrentabilidad_annual,
  avg(mcomisiones) as avg_mcomisiones,
  min(mcomisiones) as min_mcomisiones,
  max(mcomisiones) as max_mcomisiones,
  avg(mactivos_margen) as avg_mactivos_margen,
  min(mactivos_margen) as min_mactivos_margen,
  max(mactivos_margen) as max_mactivos_margen,
  avg(mpasivos_margen) as avg_mpasivos_margen,
  min(mpasivos_margen) as min_mpasivos_margen,
  max(mpasivos_margen) as max_mpasivos_margen,
  avg(mcuenta_corriente_nopaquete) as avg_mcuenta_corriente_nopaquete,
  min(mcuenta_corriente_nopaquete) as min_mcuenta_corriente_nopaquete,
  max(mcuenta_corriente_nopaquete) as max_mcuenta_corriente_nopaquete,
  avg(mcuenta_corriente_paquete) as avg_mcuenta_corriente_paquete,
  min(mcuenta_corriente_paquete) as min_mcuenta_corriente_paquete,
  max(mcuenta_corriente_paquete) as max_mcuenta_corriente_paquete,
  avg(mcuenta_corriente_dolares) as avg_mcuenta_corriente_dolares,
  min(mcuenta_corriente_dolares) as min_mcuenta_corriente_dolares,
  max(mcuenta_corriente_dolares) as max_mcuenta_corriente_dolares,
  avg(mcaja_ahorro_paquete) as avg_mcaja_ahorro_paquete,
  min(mcaja_ahorro_paquete) as min_mcaja_ahorro_paquete,
  max(mcaja_ahorro_paquete) as max_mcaja_ahorro_paquete,
  avg(mcaja_ahorro_nopaquete) as avg_mcaja_ahorro_nopaquete,
  min(mcaja_ahorro_nopaquete) as min_mcaja_ahorro_nopaquete,
  max(mcaja_ahorro_nopaquete) as max_mcaja_ahorro_nopaquete,
  avg(mcaja_ahorro_dolares) as avg_mcaja_ahorro_dolares,
  min(mcaja_ahorro_dolares) as min_mcaja_ahorro_dolares,
  max(mcaja_ahorro_dolares) as max_mcaja_ahorro_dolares,
  avg(mdescubierto_preacordado) as avg_mdescubierto_preacordado,
  min(mdescubierto_preacordado) as min_mdescubierto_preacordado,
  max(mdescubierto_preacordado) as max_mdescubierto_preacordado,
  avg(mcuentas_saldo) as avg_mcuentas_saldo,
  min(mcuentas_saldo) as min_mcuentas_saldo,
  max(mcuentas_saldo) as max_mcuentas_saldo,
  avg(mautoservicio) as avg_mautoservicio,
  min(mautoservicio) as min_mautoservicio,
  max(mautoservicio) as max_mautoservicio,
  avg(mtarjeta_visa_consumo) as avg_mtarjeta_visa_consumo,
  min(mtarjeta_visa_consumo) as min_mtarjeta_visa_consumo,
  max(mtarjeta_visa_consumo) as max_mtarjeta_visa_consumo,
  avg(mtarjeta_master_consumo) as avg_mtarjeta_master_consumo,
  min(mtarjeta_master_consumo) as min_mtarjeta_master_consumo,
  max(mtarjeta_master_consumo) as max_mtarjeta_master_consumo,
  avg(mprestamos_personales) as avg_mprestamos_personales,
  min(mprestamos_personales) as min_mprestamos_personales,
  max(mprestamos_personales) as max_mprestamos_personales,
  avg(mprestamos_prendarios) as avg_mprestamos_prendarios,
  min(mprestamos_prendarios) as min_mprestamos_prendarios,
  max(mprestamos_prendarios) as max_mprestamos_prendarios,
  avg(mprestamos_hipotecarios) as avg_mprestamos_hipotecarios,
  min(mprestamos_hipotecarios) as min_mprestamos_hipotecarios,
  max(mprestamos_hipotecarios) as max_mprestamos_hipotecarios,
  avg(mplazo_fijo_dolares) as avg_mplazo_fijo_dolares,
  min(mplazo_fijo_dolares) as min_mplazo_fijo_dolares,
  max(mplazo_fijo_dolares) as max_mplazo_fijo_dolares,
  avg(mplazo_fijo_pesos) as avg_mplazo_fijo_pesos,
  min(mplazo_fijo_pesos) as min_mplazo_fijo_pesos,
  max(mplazo_fijo_pesos) as max_mplazo_fijo_pesos,
  avg(mfondos_comunes_inversion_pesos) as avg_mfondos_comunes_inversion_pesos,
  min(mfondos_comunes_inversion_pesos) as min_mfondos_comunes_inversion_pesos,
  max(mfondos_comunes_inversion_pesos) as max_mfondos_comunes_inversion_pesos,
  avg(mfondos_comunes_inversion_dolares) as avg_mfondos_comunes_inversion_dolares,
  min(mfondos_comunes_inversion_dolares) as min_mfondos_comunes_inversion_dolares,
  max(mfondos_comunes_inversion_dolares) as max_mfondos_comunes_inversion_dolares,
  avg(mtitulos) as avg_mtitulos,
  min(mtitulos) as min_mtitulos,
  max(mtitulos) as max_mtitulos,
  avg(mbonos_corporativos) as avg_mbonos_corporativos,
  min(mbonos_corporativos) as min_mbonos_corporativos,
  max(mbonos_corporativos) as max_mbonos_corporativos,
  avg(mmonedas_extranjeras) as avg_mmonedas_extranjeras,
  min(mmonedas_extranjeras) as min_mmonedas_extranjeras,
  max(mmonedas_extranjeras) as max_mmonedas_extranjeras,
  avg(minversiones_otras) as avg_minversiones_otras,
  min(minversiones_otras) as min_minversiones_otras,
  max(minversiones_otras) as max_minversiones_otras,
  avg(mplan_sueldo) as avg_mplan_sueldo,
  min(mplan_sueldo) as min_mplan_sueldo,
  max(mplan_sueldo) as max_mplan_sueldo,
  avg(mplan_sueldo_manual) as avg_mplan_sueldo_manual,
  min(mplan_sueldo_manual) as min_mplan_sueldo_manual,
  max(mplan_sueldo_manual) as max_mplan_sueldo_manual,
  avg(mcuenta_debitos_automaticos) as avg_mcuenta_debitos_automaticos,
  min(mcuenta_debitos_automaticos) as min_mcuenta_debitos_automaticos,
  max(mcuenta_debitos_automaticos) as max_mcuenta_debitos_automaticos,
  avg(mttarjeta_visa_debitos_automaticos) as avg_mttarjeta_visa_debitos_automaticos,
  min(mttarjeta_visa_debitos_automaticos) as min_mttarjeta_visa_debitos_automaticos,
  max(mttarjeta_visa_debitos_automaticos) as max_mttarjeta_visa_debitos_automaticos,
  avg(mttarjeta_master_debitos_automaticos) as avg_mttarjeta_master_debitos_automaticos,
  min(mttarjeta_master_debitos_automaticos) as min_mttarjeta_master_debitos_automaticos,
  max(mttarjeta_master_debitos_automaticos) as max_mttarjeta_master_debitos_automaticos,
  avg(mpagodeservicios) as avg_mpagodeservicios,
  min(mpagodeservicios) as min_mpagodeservicios,
  max(mpagodeservicios) as max_mpagodeservicios,
  avg(mpagomiscuentas) as avg_mpagomiscuentas,
  min(mpagomiscuentas) as min_mpagomiscuentas,
  max(mpagomiscuentas) as max_mpagomiscuentas,
  avg(mcajeros_propios_descuentos) as avg_mcajeros_propios_descuentos,
  min(mcajeros_propios_descuentos) as min_mcajeros_propios_descuentos,
  max(mcajeros_propios_descuentos) as max_mcajeros_propios_descuentos,
  avg(mtarjeta_visa_descuentos) as avg_mtarjeta_visa_descuentos,
  min(mtarjeta_visa_descuentos) as min_mtarjeta_visa_descuentos,
  max(mtarjeta_visa_descuentos) as max_mtarjeta_visa_descuentos,
  avg(mtarjeta_master_descuentos) as avg_mtarjeta_master_descuentos,
  min(mtarjeta_master_descuentos) as min_mtarjeta_master_descuentos,
  max(mtarjeta_master_descuentos) as max_mtarjeta_master_descuentos,
  avg(mcuenta_descuentos) as avg_mcuenta_descuentos,
  min(mcuenta_descuentos) as min_mcuenta_descuentos,
  max(mcuenta_descuentos) as max_mcuenta_descuentos,
  avg(mcomisiones_mantenimiento) as avg_mcomisiones_mantenimiento,
  min(mcomisiones_mantenimiento) as min_mcomisiones_mantenimiento,
  max(mcomisiones_mantenimiento) as max_mcomisiones_mantenimiento,
  avg(mcomisiones_otras) as avg_mcomisiones_otras,
  min(mcomisiones_otras) as min_mcomisiones_otras,
  max(mcomisiones_otras) as max_mcomisiones_otras,
  avg(mcambio_monedas_compra) as avg_mcambio_monedas_compra,
  min(mcambio_monedas_compra) as min_mcambio_monedas_compra,
  max(mcambio_monedas_compra) as max_mcambio_monedas_compra,
  avg(mcambio_monedas_venta) as avg_mcambio_monedas_venta,
  min(mcambio_monedas_venta) as min_mcambio_monedas_venta,
  max(mcambio_monedas_venta) as max_mcambio_monedas_venta,
  avg(mtransferencias_recibidas) as avg_mtransferencias_recibidas,
  min(mtransferencias_recibidas) as min_mtransferencias_recibidas,
  max(mtransferencias_recibidas) as max_mtransferencias_recibidas,
  avg(mtransferencias_emitidas) as avg_mtransferencias_emitidas,
  min(mtransferencias_emitidas) as min_mtransferencias_emitidas,
  max(mtransferencias_emitidas) as max_mtransferencias_emitidas,
  avg(mextraccion_autoservicio) as avg_mextraccion_autoservicio,
  min(mextraccion_autoservicio) as min_mextraccion_autoservicio,
  max(mextraccion_autoservicio) as max_mextraccion_autoservicio,
  avg(mcheques_depositados) as avg_mcheques_depositados,
  min(mcheques_depositados) as min_mcheques_depositados,
  max(mcheques_depositados) as max_mcheques_depositados,
  avg(mcheques_emitidos) as avg_mcheques_emitidos,
  min(mcheques_emitidos) as min_mcheques_emitidos,
  max(mcheques_emitidos) as max_mcheques_emitidos,
  avg(mcheques_depositados_rechazados) as avg_mcheques_depositados_rechazados,
  min(mcheques_depositados_rechazados) as min_mcheques_depositados_rechazados,
  max(mcheques_depositados_rechazados) as max_mcheques_depositados_rechazados,
  avg(mcheques_emitidos_rechazados) as avg_mcheques_emitidos_rechazados,
  min(mcheques_emitidos_rechazados) as min_mcheques_emitidos_rechazados,
  max(mcheques_emitidos_rechazados) as max_mcheques_emitidos_rechazados,
  avg(chomebanking_transacciones) as avg_chomebanking_transacciones,
  min(chomebanking_transacciones) as min_chomebanking_transacciones,
  max(chomebanking_transacciones) as max_chomebanking_transacciones,
  avg(mcajeros_propio) as avg_mcajeros_propio,
  min(mcajeros_propio) as min_mcajeros_propio,
  max(mcajeros_propio) as max_mcajeros_propio,
  avg(ccajeros_propio_transacciones) as avg_ccajeros_propio_transacciones,
  min(ccajeros_propio_transacciones) as min_ccajeros_propio_transacciones,
  max(ccajeros_propio_transacciones) as max_ccajeros_propio_transacciones,
  avg(ccajeros_ajenos_transacciones) as avg_ccajeros_ajenos_transacciones,
  min(ccajeros_ajenos_transacciones) as min_ccajeros_ajenos_transacciones,
  max(ccajeros_ajenos_transacciones) as max_ccajeros_ajenos_transacciones,
  avg(mcajeros_ajenos) as avg_mcajeros_ajenos,
  min(mcajeros_ajenos) as min_mcajeros_ajenos,
  max(mcajeros_ajenos) as max_mcajeros_ajenos,
  avg(tmovimientos_ultimos90dias) as avg_tmovimientos_ultimos90dias,
  min(tmovimientos_ultimos90dias) as min_tmovimientos_ultimos90dias,
  max(tmovimientos_ultimos90dias) as max_tmovimientos_ultimos90dias,
  avg(master_mfinanciacion_limite) as avg_master_mfinanciacion_limite,
  min(master_mfinanciacion_limite) as min_master_mfinanciacion_limite,
  max(master_mfinanciacion_limite) as max_master_mfinanciacion_limite,
  avg(master_msaldototal) as avg_master_msaldototal,
  min(master_msaldototal) as min_master_msaldototal,
  max(master_msaldototal) as max_master_msaldototal,
  avg(master_msaldopesos) as avg_master_msaldopesos,
  min(master_msaldopesos) as min_master_msaldopesos,
  max(master_msaldopesos) as max_master_msaldopesos,
  avg(master_msaldodolares) as avg_master_msaldodolares,
  min(master_msaldodolares) as min_master_msaldodolares,
  max(master_msaldodolares) as max_master_msaldodolares,
  avg(master_mconsumospesos) as avg_master_mconsumospesos,
  min(master_mconsumospesos) as min_master_mconsumospesos,
  max(master_mconsumospesos) as max_master_mconsumospesos,
  avg(master_mconsumosdolares) as avg_master_mconsumosdolares,
  min(master_mconsumosdolares) as min_master_mconsumosdolares,
  max(master_mconsumosdolares) as max_master_mconsumosdolares,
  avg(master_mlimitecompra) as avg_master_mlimitecompra,
  min(master_mlimitecompra) as min_master_mlimitecompra,
  max(master_mlimitecompra) as max_master_mlimitecompra,
  avg(master_madelantopesos) as avg_master_madelantopesos,
  min(master_madelantopesos) as min_master_madelantopesos,
  max(master_madelantopesos) as max_master_madelantopesos,
  avg(master_madelantodolares) as avg_master_madelantodolares,
  min(master_madelantodolares) as min_master_madelantodolares,
  max(master_madelantodolares) as max_master_madelantodolares,
  avg(master_mpagado) as avg_master_mpagado,
  min(master_mpagado) as min_master_mpagado,
  max(master_mpagado) as max_master_mpagado,
  avg(master_mpagospesos) as avg_master_mpagospesos,
  min(master_mpagospesos) as min_master_mpagospesos,
  max(master_mpagospesos) as max_master_mpagospesos,
  avg(master_mpagosdolares) as avg_master_mpagosdolares,
  min(master_mpagosdolares) as min_master_mpagosdolares,
  max(master_mpagosdolares) as max_master_mpagosdolares,
  avg(master_mconsumototal) as avg_master_mconsumototal,
  min(master_mconsumototal) as min_master_mconsumototal,
  max(master_mconsumototal) as max_master_mconsumototal,
  avg(master_tconsumos) as avg_master_tconsumos,
  min(master_tconsumos) as min_master_tconsumos,
  max(master_tconsumos) as max_master_tconsumos,
  avg(master_mpagominimo) as avg_master_mpagominimo,
  min(master_mpagominimo) as min_master_mpagominimo,
  max(master_mpagominimo) as max_master_mpagominimo,
  avg(visa_mfinanciacion_limite) as avg_visa_mfinanciacion_limite,
  min(visa_mfinanciacion_limite) as min_visa_mfinanciacion_limite,
  max(visa_mfinanciacion_limite) as max_visa_mfinanciacion_limite,
  avg(visa_msaldototal) as avg_visa_msaldototal,
  min(visa_msaldototal) as min_visa_msaldototal,
  max(visa_msaldototal) as max_visa_msaldototal,
  avg(visa_msaldopesos) as avg_visa_msaldopesos,
  min(visa_msaldopesos) as min_visa_msaldopesos,
  max(visa_msaldopesos) as max_visa_msaldopesos,
  avg(visa_msaldodolares) as avg_visa_msaldodolares,
  min(visa_msaldodolares) as min_visa_msaldodolares,
  max(visa_msaldodolares) as max_visa_msaldodolares,
  avg(visa_mconsumospesos) as avg_visa_mconsumospesos,
  min(visa_mconsumospesos) as min_visa_mconsumospesos,
  max(visa_mconsumospesos) as max_visa_mconsumospesos,
  avg(visa_mconsumosdolares) as avg_visa_mconsumosdolares,
  min(visa_mconsumosdolares) as min_visa_mconsumosdolares,
  max(visa_mconsumosdolares) as max_visa_mconsumosdolares,
  avg(visa_madelantopesos) as avg_visa_madelantopesos,
  min(visa_madelantopesos) as min_visa_madelantopesos,
  max(visa_madelantopesos) as max_visa_madelantopesos,
  avg(visa_madelantodolares) as avg_visa_madelantodolares,
  min(visa_madelantodolares) as min_visa_madelantodolares,
  max(visa_madelantodolares) as max_visa_madelantodolares,
  avg(visa_mpagado) as avg_visa_mpagado,
  min(visa_mpagado) as min_visa_mpagado,
  max(visa_mpagado) as max_visa_mpagado,
  avg(visa_mpagospesos) as avg_visa_mpagospesos,
  min(visa_mpagospesos) as min_visa_mpagospesos,
  max(visa_mpagospesos) as max_visa_mpagospesos,
  avg(visa_mpagosdolares) as avg_visa_mpagosdolares,
  min(visa_mpagosdolares) as min_visa_mpagosdolares,
  max(visa_mpagosdolares) as max_visa_mpagosdolares,
  avg(visa_mconsumototal) as avg_visa_mconsumototal,
  min(visa_mconsumototal) as min_visa_mconsumototal,
  max(visa_mconsumototal) as max_visa_mconsumototal,
  avg(visa_tconsumos) as avg_visa_tconsumos,
  min(visa_tconsumos) as min_visa_tconsumos,
  max(visa_tconsumos) as max_visa_tconsumos,
  avg(visa_tadelantosefectivo) as avg_visa_tadelantosefectivo,
  min(visa_tadelantosefectivo) as min_visa_tadelantosefectivo,
  max(visa_tadelantosefectivo) as max_visa_tadelantosefectivo,
  avg(visa_mpagominimo) as avg_visa_mpagominimo,
  min(visa_mpagominimo) as min_visa_mpagominimo,
  max(visa_mpagominimo) as max_visa_mpagominimo
 into groups_by_cliente
 from fct_prod_premium
 where foto_mes between 201511 and 201604
 group by numero_de_cliente;